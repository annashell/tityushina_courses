{"ast":null,"code":"import{useParams}from'react-router-dom';import{useState,useEffect}from'react';import{getCourseDetails}from'../../api/courses';import'./ChapterPage.css';import SideMenu from\"../../components/SideMenu/SideMenu\";import{MathJaxContext}from\"better-react-mathjax\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ChapterPage(){const{courseId,chapterId}=useParams();const[chapter,setChapter]=useState(null);const[content,setContent]=useState('');const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{// Загружаем метаданные главы\ngetCourseDetails(courseId).then(course=>{const foundChapter=course.chapters.find(ch=>ch.id===parseInt(chapterId));if(!foundChapter){throw new Error('Chapter not found');}setChapter(foundChapter);// Загружаем HTML-контент из public\nreturn fetch(\"\".concat(process.env.PUBLIC_URL,\"/courses/\").concat(courseId,\"/\").concat(foundChapter.filename));}).then(response=>{if(!response.ok)throw new Error('Failed to load chapter content');return response.text();})// .then(html => {\n//     setContent(html);\n//     setLoading(false);\n// })\n.then(html=>{// Фикс путей к изображениям\nconst fixedHtml=html.replaceAll(/src=\"img\\//g,\"src=\\\"\".concat(process.env.PUBLIC_URL,\"/courses/\").concat(courseId,\"/img/\"));console.log(\"html\",process.env.PUBLIC_URL,\"src=\\\"\".concat(process.env.PUBLIC_URL,\"/courses/\").concat(courseId,\"/img/\"));setContent(fixedHtml);setLoading(false);}).catch(err=>{setError(err.message);setLoading(false);});},[courseId,chapterId]);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0433\\u043B\\u0430\\u0432\\u044B...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \",error]});if(!chapter)return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"\\u0413\\u043B\\u0430\\u0432\\u0430 \\u043D\\u0435 \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u0430\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"chapter-page\",children:[/*#__PURE__*/_jsx(SideMenu,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"chapter-page-content\",children:[/*#__PURE__*/_jsx(\"h2\",{children:chapter.title}),/*#__PURE__*/_jsx(MathJaxContext,{children:/*#__PURE__*/_jsx(\"div\",{className:\"chapter-content\",dangerouslySetInnerHTML:{__html:content}})})]})]});}export default ChapterPage;","map":{"version":3,"names":["useParams","useState","useEffect","getCourseDetails","SideMenu","MathJaxContext","jsx","_jsx","jsxs","_jsxs","ChapterPage","courseId","chapterId","chapter","setChapter","content","setContent","loading","setLoading","error","setError","then","course","foundChapter","chapters","find","ch","id","parseInt","Error","fetch","concat","process","env","PUBLIC_URL","filename","response","ok","text","html","fixedHtml","replaceAll","console","log","catch","err","message","className","children","title","dangerouslySetInnerHTML","__html"],"sources":["D:/projects/tityushina_courses/src/pages/ChapterPage/ChapterPage.jsx"],"sourcesContent":["import {useParams} from 'react-router-dom';\r\nimport {useState, useEffect} from 'react';\r\nimport {getCourseDetails} from '../../api/courses';\r\nimport './ChapterPage.css';\r\nimport SideMenu from \"../../components/SideMenu/SideMenu\";\r\nimport {MathJaxContext} from \"better-react-mathjax\";\r\n\r\nfunction ChapterPage() {\r\n    const {courseId, chapterId} = useParams();\r\n    const [chapter, setChapter] = useState(null);\r\n    const [content, setContent] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        // Загружаем метаданные главы\r\n        getCourseDetails(courseId)\r\n            .then(course => {\r\n                const foundChapter = course.chapters.find(ch => ch.id === parseInt(chapterId));\r\n                if (!foundChapter) {\r\n                    throw new Error('Chapter not found');\r\n                }\r\n                setChapter(foundChapter);\r\n\r\n                // Загружаем HTML-контент из public\r\n                return fetch(`${process.env.PUBLIC_URL}/courses/${courseId}/${foundChapter.filename}`);\r\n            })\r\n            .then(response => {\r\n                if (!response.ok) throw new Error('Failed to load chapter content');\r\n                return response.text();\r\n            })\r\n            // .then(html => {\r\n            //     setContent(html);\r\n            //     setLoading(false);\r\n            // })\r\n            .then(html => {\r\n                // Фикс путей к изображениям\r\n                const fixedHtml = html.replaceAll(\r\n                  /src=\"img\\//g, \r\n                  `src=\"${process.env.PUBLIC_URL}/courses/${courseId}/img/`\r\n                );\r\n                console.log(\"html\", process.env.PUBLIC_URL, `src=\"${process.env.PUBLIC_URL}/courses/${courseId}/img/`)\r\n                setContent(fixedHtml);\r\n                setLoading(false);\r\n              })\r\n            .catch(err => {\r\n                setError(err.message);\r\n                setLoading(false);\r\n            });\r\n    }, [courseId, chapterId]);\r\n\r\n    if (loading) return <div className=\"loading\">Загрузка главы...</div>;\r\n    if (error) return <div className=\"error\">Ошибка: {error}</div>;\r\n    if (!chapter) return <div className=\"error\">Глава не найдена</div>;\r\n\r\n    return (\r\n        <div className=\"chapter-page\">\r\n            <SideMenu/>\r\n            <div className=\"chapter-page-content\">\r\n                <h2>{chapter.title}</h2>\r\n                <MathJaxContext>\r\n                    <div className=\"chapter-content\"\r\n                         dangerouslySetInnerHTML={{__html: content}}\r\n                    />\r\n                </MathJaxContext>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChapterPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}